"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[309],{9309:(e,r,a)=>{a.r(r),a.d(r,{default:()=>z});var i=a(9379),o=a(5043),t=a(9961),n=a(3969),l=a(7203),d=a(7471),s=a(172),c=a(2097),h=a(3023),A=a(1911),u=a(8776),x=a(5877),v=a(5895),f=a(3665),j=a(9302),m=a(2911),g=a(3830),b=a(267),p=a(6995),C=a(579);const y=["Activo","Llamada"],w=["F","M","Otro"];function N(e){const r=Math.floor(e-25569),a=new Date(1e3*(86400*(r+1))),i=e-Math.floor(e)+1e-7;let o=Math.floor(86400*i),t=o%60;o-=t;let n=Math.floor(o/3600),l=Math.floor(o/60)%60;return a.setHours(n),a.setMinutes(l),a.setSeconds(t),a}function z(){const[e,r]=(0,o.useState)([]),[a,z]=(0,o.useState)(!0),[E,S]=(0,o.useState)(null),[F,k]=(0,o.useState)(null),[T,D]=(0,o.useState)(null),[P,R]=(0,o.useState)(!1),[I,L]=(0,o.useState)(!1),[M,O]=(0,o.useState)({open:!1,message:"",severity:"info"}),G=(0,b.A)(),W=(0,p.A)(G.breakpoints.down("sm"));(0,o.useEffect)(()=>{fetch("http://localhost:3001/api/voluntarios").then(e=>e.json()).then(e=>{Array.isArray(e)&&0!==e.length?r(e.map((e,r)=>(0,i.A)({id:r+1},e))):r([{id:1}]),z(!1)}).catch(e=>{console.error("Error al cargar voluntarios:",e),r([{id:1}]),z(!1)})},[]);const U=()=>{R(!1),D(null)},H=[{field:"id",headerName:"ID",width:52},{field:"acciones",headerName:"",width:60,sortable:!1,filterable:!1,renderCell:e=>(0,C.jsx)(c.A,{size:"small",onClick:()=>{return r=e.row,D(r),void R(!0);var r},sx:{borderColor:"#9c1821",color:"#9c1821",minWidth:"40px",padding:"4px","&:hover":{borderColor:"#7a1419",backgroundColor:"rgba(156, 24, 33, 0.04)"}},children:(0,C.jsx)(f.A,{fontSize:"small"})})},{field:"Filial",headerName:"Filial",width:120},{field:"Calidad de voluntario",headerName:"Calidad de voluntario",width:180,renderCell:a=>{const{id:o,value:t}=a;return E===o?(0,C.jsx)(s.A,{size:20}):(0,C.jsx)(l.A,{value:t,onChange:a=>((a,o)=>{S(a);const t=e.find(e=>e.id===a);fetch("http://localhost:3001/api/voluntarios/".concat(t._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({"Calidad de voluntario":o})}).then(e=>{e.ok?(r(e=>e.map(e=>e.id===a?(0,i.A)((0,i.A)({},e),{},{"Calidad de voluntario":o}):e)),window.dispatchEvent(new Event("refreshFiliales"))):alert("Error al actualizar!"),S(null)}).catch(()=>{alert("Error al actualizar!"),S(null)})})(o,a.target.value),size:"small",sx:{minWidth:120},children:y.map(e=>(0,C.jsx)(d.A,{value:e,children:e},e))})}},{field:"Nombres voluntario",headerName:"Nombres voluntario",width:150},{field:"Apellidos voluntarios",headerName:"Apellidos voluntarios",width:170},{field:"RUT",headerName:"RUT",width:130},{field:"Fecha de ingreso",headerName:"Fecha de ingreso",width:150,renderCell:e=>{if(!e.value)return"";return N(e.value).toLocaleDateString("es-CL")}},{field:"Fecha nacimiento",headerName:"Fecha nacimiento",width:150,renderCell:e=>{if(!e.value)return"";return N(e.value).toLocaleDateString("es-CL")}},{field:"Correo",headerName:"Correo",width:180},{field:"Direccion",headerName:"Direcci\xf3n",width:180},{field:"Telefono",headerName:"Tel\xe9fono",width:130},{field:"Cargo",headerName:"Cargo",width:120},{field:"Edad",headerName:"Edad",width:90},{field:"Edad de ingreso a CRC",headerName:"Edad ingreso CRC",width:160,renderCell:e=>{const r=e.value;return r?Math.round(r).toString():"N/A"}},{field:"Antig\xfcedad",headerName:"Antig\xfcedad",width:120},{field:"G\xe9nero",headerName:"G\xe9nero",width:100,renderCell:a=>{const{id:o,value:t}=a;return F===o?(0,C.jsx)(s.A,{size:20}):(0,C.jsx)(l.A,{value:t||"",onChange:a=>((a,o)=>{k(a);const t=e.find(e=>e.id===a);fetch("http://localhost:3001/api/voluntarios/".concat(t._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({"G\xe9nero":o})}).then(e=>{e.ok?(r(e=>e.map(e=>e.id===a?(0,i.A)((0,i.A)({},e),{},{"G\xe9nero":o}):e)),window.dispatchEvent(new Event("refreshFiliales"))):alert("Error al actualizar g\xe9nero!"),k(null)}).catch(()=>{alert("Error al actualizar g\xe9nero!"),k(null)})})(o,a.target.value),size:"small",sx:{minWidth:70},children:w.map(e=>(0,C.jsx)(d.A,{value:e,children:e},e))})}},{field:"Instructores de PPAA B\xe1sico",headerName:"PPAA B\xe1sico",width:140},{field:"Instructores de PPAA Avanzado",headerName:"PPAA Avanzado",width:150},{field:"Instructores doctrina",headerName:"Instructores doctrina",width:140}],V=W?H.filter(e=>["id","Filial","Calidad de voluntario","Nombres voluntario","RUT"].includes(e.field)):H;return(0,C.jsxs)("div",{children:[(0,C.jsx)(n.A,{sx:{mb:2,display:"flex",justifyContent:"flex-end",pr:2},children:(0,C.jsx)(c.A,{variant:"contained",startIcon:(0,C.jsx)(j.A,{}),onClick:async()=>{L(!0),O({open:!1,message:"",severity:"info"});try{const e=await fetch("http://localhost:3001/api/actualizarEdades",{method:"POST",headers:{"Content-Type":"application/json"}}),r=await e.json();O({open:!0,message:r.mensaje||"Actualizaci\xf3n completada",severity:e.ok?"success":"error"}),e.ok&&setTimeout(()=>window.location.reload(),1500)}catch(e){console.error("Error:",e),O({open:!0,message:"Error al actualizar edades. Verifica que el backend est\xe9 corriendo.",severity:"error"})}finally{L(!1)}},disabled:I,sx:{backgroundColor:"#9c1821","&:hover":{backgroundColor:"#7a1419"},boxShadow:"0 4px 12px rgba(156, 24, 33, 0.3)"},size:"small",children:I?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(s.A,{size:20,sx:{mr:1,color:"white"}}),"Actualizando..."]}):"Actualizar Edades y Antig\xfcedad"})}),(0,C.jsx)(n.A,{sx:{height:{xs:600,sm:550,md:490},width:"100%",maxWidth:{xs:"100%",sm:1e3},margin:"auto",background:"#fff",borderRadius:2,boxShadow:1,overflowX:"auto",p:{xs:1,sm:2}},children:(0,C.jsx)(t.z,{rows:e,columns:V,pageSize:W?10:15,rowsPerPageOptions:W?[10,15]:[15,25,50],loadingOverlayVisibility:a,disableSelectionOnClick:!0,getRowId:e=>e.id,suppressCellFocus:!0})}),(0,C.jsx)(m.A,{open:M.open,autoHideDuration:5e3,onClose:()=>O((0,i.A)((0,i.A)({},M),{},{open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,C.jsx)(g.A,{onClose:()=>O((0,i.A)((0,i.A)({},M),{},{open:!1})),severity:M.severity,sx:{width:"100%"},children:M.message})}),(0,C.jsxs)(h.A,{open:P,onClose:U,maxWidth:"md",fullWidth:!0,children:[(0,C.jsx)(A.A,{sx:{bgcolor:"#9c1821",color:"#fff"},children:"Detalles del Voluntario"}),(0,C.jsx)(u.A,{sx:{mt:2},children:T&&(0,C.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,C.jsxs)(n.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2},children:[(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Nombre"}),(0,C.jsx)(v.A,{variant:"body1",children:T["Nombres voluntario"]||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Apellido"}),(0,C.jsx)(v.A,{variant:"body1",children:T["Apellidos voluntarios"]||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"RUT"}),(0,C.jsx)(v.A,{variant:"body1",children:T.RUT||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Fecha de Nacimiento"}),(0,C.jsx)(v.A,{variant:"body1",children:T["Fecha nacimiento"]?N(T["Fecha nacimiento"]).toLocaleDateString("es-CL"):"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Edad"}),(0,C.jsx)(v.A,{variant:"body1",children:T.Edad||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"G\xe9nero"}),(0,C.jsx)(v.A,{variant:"body1",children:T["G\xe9nero"]||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Filial"}),(0,C.jsx)(v.A,{variant:"body1",children:T.Filial||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Fecha de Ingreso"}),(0,C.jsx)(v.A,{variant:"body1",children:T["Fecha de ingreso"]?N(T["Fecha de ingreso"]).toLocaleDateString("es-CL"):"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Correo"}),(0,C.jsx)(v.A,{variant:"body1",children:T.Correo||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Direcci\xf3n"}),(0,C.jsx)(v.A,{variant:"body1",children:T.Direccion||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Tel\xe9fono"}),(0,C.jsx)(v.A,{variant:"body1",children:T.Telefono||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Cargo"}),(0,C.jsx)(v.A,{variant:"body1",children:T.Cargo||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Edad de Ingreso"}),(0,C.jsx)(v.A,{variant:"body1",children:T["Edad de ingreso a CRC"]||"N/A"})]}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(v.A,{variant:"subtitle2",color:"text.secondary",children:"Antig\xfcedad"}),(0,C.jsx)(v.A,{variant:"body1",children:T["Antig\xfcedad"]||"N/A"})]})]})})}),(0,C.jsx)(x.A,{children:(0,C.jsx)(c.A,{onClick:U,variant:"contained",sx:{bgcolor:"#9c1821","&:hover":{bgcolor:"#7a1419"}},children:"Cerrar"})})]})]})}}}]);
//# sourceMappingURL=309.fd641f64.chunk.js.map